<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>M2</title>
    <meta name="viewport" id="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0" />
    <meta name="format-detection" content="telephone=no, address=no, email=no" />
    <meta name="apple-mobile-web-app-title" content="M2" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <script type="text/javascript" src="/js/m2/include.js"></script>
</head>
<body class="bgDef">
<div class="wrap hasHeader">


    <div id="header">
        <div class="_l">
            <div class="headerIcon"><a href="/login"><img src="/images/m2/common/iconBack.png" alt="뒤로" /></a></div>
            <h1 class="headerTitle">무료회원가입</h1>
        </div>
    </div>
    <div id="content">
        <div class="join">
            <form name="user" method="post" action="/user/register" onsubmit="return submitCheck(); return false;">
            <input type="text" name="agreeYn" id="agreeYn" value="" />
            <div class="joinForm">
                <div class="formArea">
                    <div class="_l">
                        <div class="formsGroup">
                            <div class="form hasLabel hasBtn full">
                                <label class="labelId">아이디</label>
                                <span class="formMsg">필수 입력</span>
                                <input type="text" id="id" name="id" autocomplete="off" class="focusAct"  />
                                <button id="findId" type="button">중복확인</button>
                            </div>
                            <div class="form hasLabel full">
                                <label class="labelId">비밀번호</label>
                                <span class="formMsg">필수 입력</span>
                                <input type="password" id="password" name="password" autocomplete="off" class="focusAct" />
                            </div>
                            <div class="form hasLabel full">
                                <label class="labelId">비밀번호 확인</label>
                                <span class="formMsg">필수 입력</span>
                                <input type="password" id="password2" autocomplete="off" class="focusAct" />
                            </div>
                            <div class="form hasLabel full">
                                <label class="labelId">이름</label>
                                <span class="formMsg">필수 입력</span>
                                <input type="text" id="name" name="name" autocomplete="off" class="focusAct" />
                            </div>
                            <div class="form hasLabel full">
                                <label class="labelId">전화번호</label>
                                <span class="formMsg">필수 입력</span>
                                <input type="number" id="phone" name="phone" pattern="[0-9]*" inputmode="numeric" min="0" autocomplete="off" class="tal focusAct" oninput="maxLengthCheckPhone(this)" />
                            </div>
                            <div class="form hasLabel full">
                                <label class="labelId">이메일</label>
                                <span class="formMsg">필수 입력</span>
                                <input type="text" id="email" name="email" autocomplete="off" class="focusAct" />
                            </div>
                            <div class="form check full">
                                <label>
                                    <input type="checkbox" checked="checked" id="agreeYnCheck" />
                                    <strong>메일 알림 동의<span class="guide">사용자의 서비스 이용 중 진행상황 알림 메일 발송.</span></strong>
                                </label>
                                <label>
                                    <input type="checkbox" checked="checked" id="privacyYnCheck" />
                                    <strong>약관 동의<a href="#" id="privacyPopup" style="padding-left:10px;color:yellow;text-decoration:underline;display:inline-block;">약관 보기</a></strong>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="submitArea">
                    <input type="submit" value="무료회원가입" />
                </div>
            </div>
            </form>
        </div>
    </div>

    <div class="popupArea">
        <div class="dimmed"></div>
        <div class="popup hasReaction guide">
            <div class="popupContent">
                <div class="popupMsg">등록중입니다. </div>
            </div>
        </div>
    </div>

</div>

<script type="text/javascript" src="/js/m2/ui.tmpl.js"></script>
<script type="text/javascript" src="/js/hbs/handlebars-v4.0.11.js"></script>
<script type="text/javascript">
function emailCheck(email) {
    email = $.trim(email);
    var regex=/([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
    return (email != '' && email != 'undefined' && regex.test(email));
}

function idCheck(id) {
    var pattern = new RegExp(/^[a-z0-9]+$/);
    return pattern.test(id);
}

function idDupCheck(id) {
    var check=false;
    $.ajax({
        url:"/user/findId?id="+id,
        async: false,
        success:function(data) {
            if(data=='success'){
                check=true;
            }
        }
    });
    return check;
}

function blankCheck(val) {
    var check=true;
    if( val == '' || val == 'undefined') {
        check=false;
    }
    return check;
}

function submitCheck(){
    var id = $("#id").val();

    if(!blankCheck(id)) {
        alert("ID를 입력하세요.");
        $("#id").focus();
        return false;
    }else{
        if(!idCheck(id)){
            alert("ID는 영문, 숫자만 사용가능합니다");
            $("#id").focus();
            $("#id").val("");
            return false;
        }
        if(!idDupCheck(id)){
            alert("중복된 ID 사용불가");
            $("#id").focus();
            return false;
        }
    }

    var password = $("#password").val();
    var password2 = $("#password2").val();

    if(!blankCheck(password)) {
        alert("비밀번호를 입력하세요.");
        $("#password").focus();
        return false;
    }else{
        if(password!=password2){
            alert("비밀번호와 비밀번호 확인이 다릅니다.");
            return false;
        }
    }

    var name = $("#name").val();
    if(!blankCheck(name)) {
        alert("이름을 입력하세요.");
        $("#name").focus();
        return false;
    }
    $("#name").val($.trim(name));

    var phone = $("#phone").val();
    if(!blankCheck(phone)) {
        alert("전화번호를 입력하세요.");
        $("#phone").focus();
        return false;
    }

    var email = $("#email").val();
    if(!blankCheck(id)) {
        alert("메일주소를 입력하세요.");
        $("#email").focus();
        return false;
    }else{
        if(! emailCheck(email) ) {
            alert('잘못된 형식의 이메일 주소입니다.');
            return false;
        }
    }
    $("#email").val($.trim(email));

    if($("#agreeYnCheck").is(":checked")){
        $("#agreeYn").val("Y");
    }else{
        $("#agreeYn").val("N");
    }

    if(!$("#privacyYnCheck").is(":checked")){
        alert('약관 동의에 체크하세요.');
        return false;
    }

    $(".popupArea").addClass("on");

}
function maxLengthCheckPhone(object){
    if(object.value.length > 12) {
        object.value = object.value.slice(0, 12);
    }
}
$(document).ready(function(){
    $('#privacyPopup').bind('click', function() {
        $(document.body).css({"overflow": "hidden"});
        var sTmpl = "/privacyPopup.html";
        var sContainer = "body";
        var oData = {};

        ui.tmpl.setTmpl({
            tmpl: sTmpl,
            container: sContainer,
            data: oData,
            type: 'append',
            empty: false,
            callback: function () {
                $(".ly_cls>a").click(function() {
                    var target = $(event.currentTarget);
                    target.parents('.dim_block').remove();
                    $(document.body).css({
                        "overflow": "visible",
                    });
                });
            }
        });
    });

    $("#findId").click(function() {
        var id = $("#id").val();
        if(!blankCheck(id)) {
            alert("ID를 입력하세요.");
            $("#id").focus();
            return false;
        }else{
            if(!idCheck(id)){
                alert("ID는 영문, 숫자만 사용가능합니다");
                $("#id").focus();
                $("#id").val("");
                return false;
            }
            if(!idDupCheck(id)){
                alert("중복된 ID 사용불가");
                return false;
            }else{
                alert("사용가능한 ID입니다. ");
            }
        }

    });
});
</script>

<script type="text/javascript" src="//wcs.naver.net/wcslog.js"></script>
<script type="text/javascript">
    if(!wcs_add) var wcs_add = {};
    wcs_add["wa"] = "b99938aa251970";
    wcs_do();
</script>
</body>
</html>